# توجيه العقود الهندسية (Engineering Contracts Steering)

## المبدأ الأساسي: التصميم بالعقد (Design by Contract - DbC)

يجب أن يتم تصميم جميع الواجهات العامة (Public Interfaces) والدوال (Functions) والخدمات (Services) بعقد واضح يحدد سلوكها بدقة. هذا يضمن أن الكود المولد من قبل الوكيل يكون دقيقًا وقابلاً للتحقق الرسمي.

## 1. مكونات العقد الإلزامية

يجب أن يتم توثيق كل دالة أو واجهة عامة باستخدام التعليقات (Docstrings) لتحديد المكونات الثلاثة التالية:

| المكون | الوصف | التوجيه للوكيل |
| :--- | :--- | :--- |
| **الشروط المسبقة (Preconditions)** | الشروط التي يجب أن تكون صحيحة قبل تنفيذ الدالة. إذا لم يتم استيفاؤها، يجب أن ترفض الدالة التنفيذ (مثل إرجاع خطأ). | يجب على الوكيل توليد كود يتحقق من صحة المدخلات (Input Validation) في بداية الدالة. |
| **الشروط اللاحقة (Postconditions)** | الشروط التي يجب أن تكون صحيحة بعد انتهاء تنفيذ الدالة بنجاح. | يجب على الوكيل التأكد من أن القيمة المرجعة أو حالة النظام تعكس النتيجة المتوقعة للعقد. |
| **الثوابت (Invariants)** | الشروط التي يجب أن تظل صحيحة طوال دورة حياة الكائن أو الخدمة. | يجب على الوكيل التأكد من أن الكود لا ينتهك حالة الكائن الداخلية. |

## 2. تطبيق DbC على المكدس التقني

### أ. Go (الواجهة الخلفية)

*   **التوجيه:** يجب استخدام التعليقات التوثيقية (Godoc) لتحديد Preconditions و Postconditions لكل دالة عامة.
*   **مثال:** يجب أن يتضمن الكود التحقق من الأخطاء (Error Handling) لضمان أن الشروط المسبقة غير المستوفاة تؤدي إلى إرجاع خطأ واضح.

### ب. Flutter (الواجهة الأمامية)

*   **التوجيه:** يجب استخدام `assert()` في Dart للتحقق من الشروط المسبقة في وضع التطوير (Development Mode) لضمان صحة المدخلات.
*   **مثال:** يجب أن يتم التحقق من أن جميع المعلمات المطلوبة (Required Parameters) للمكونات غير فارغة.

## 3. التحقق من الامتثال

يجب على وكيل المراجعة (`prReview.prompt.md`) التحقق بشكل إلزامي مما يلي:

1.  هل تم توثيق جميع الواجهات العامة بالعقد (Preconditions, Postconditions)؟
2.  هل يضمن الكود المولد التحقق من الشروط المسبقة (مثل التحقق من صحة المدخلات)؟
3.  هل يتوافق سلوك الدالة مع الشروط اللاحقة المحددة؟
